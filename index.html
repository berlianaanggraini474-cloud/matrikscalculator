<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator Matriks Dinamis</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #000000, #ff69b4);
      color: white;
      text-align: center;
      padding: 30px;
    }
    h1 {
      margin-bottom: 20px;
    }
    select, input[type="number"] {
      margin: 5px;
      padding: 5px;
    }
    .matrix-container {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
    }
    .matrix {
      display: grid;
      gap: 5px;
    }
    .matrix input {
      width: 50px;
      height: 30px;
      text-align: center;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .buttons {
      margin-top: 20px;
    }
    button {
      background-color: #ff69b4;
      color: black;
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .result {
      margin-top: 30px;
    }
    .matrix-label {
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Kalkulator Matriks Dinamis</h1>
  
  <label for="rows">Baris:</label>
  <select id="rows" onchange="createMatrices()">
    <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
  </select>
  <label for="cols">Kolom:</label>
  <select id="cols" onchange="createMatrices()">
    <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
  </select>
  
  <div class="matrix-container">
    <div>
      <div class="matrix-label">Matrix A</div>
      <div id="matrixA" class="matrix"></div>
    </div>
    <div>
      <div class="matrix-label">Matrix B</div>
      <div id="matrixB" class="matrix"></div>
    </div>
  </div>

  <div class="buttons">
    <button onclick="operate('add')">Tambah</button>
    <button onclick="operate('subtract')">Kurang</button>
    <button onclick="operate('multiply')">Kali</button>
    <button onclick="operate('transpose')">Transpose A</button>
    <button onclick="operate('determinant')">Determinan A</button>
    <button onclick="operate('inverse')">Inverse A</button>
    <button onclick="clearAll()">Bersihkan</button>
  </div>

  <div class="result">
    <h3>Hasil:</h3>
    <div id="result" class="matrix"></div>
  </div>

  <script>
    const createMatrices = () => {
      const rows = parseInt(document.getElementById('rows').value);
      const cols = parseInt(document.getElementById('cols').value);
      const matrixA = document.getElementById('matrixA');
      const matrixB = document.getElementById('matrixB');
      matrixA.innerHTML = '';
      matrixB.innerHTML = '';
      matrixA.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
      matrixB.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      for (let i = 0; i < rows * cols; i++) {
        let inputA = document.createElement('input');
        inputA.type = 'number';
        inputA.id = 'a' + i;
        matrixA.appendChild(inputA);

        let inputB = document.createElement('input');
        inputB.type = 'number';
        inputB.id = 'b' + i;
        matrixB.appendChild(inputB);
      }
    };

    const getMatrix = (idPrefix, rows, cols) => {
      const matrix = [];
      for (let r = 0; r < rows; r++) {
        const row = [];
        for (let c = 0; c < cols; c++) {
          const val = parseFloat(document.getElementById(idPrefix + (r * cols + c)).value) || 0;
          row.push(val);
        }
        matrix.push(row);
      }
      return matrix;
    };

    const displayResult = (matrix) => {
      const result = document.getElementById('result');
      result.innerHTML = '';
      if (typeof matrix === 'number') {
        result.innerText = matrix.toFixed(2);
        return;
      }
      result.style.gridTemplateColumns = `repeat(${matrix[0].length}, 1fr)`;
      for (let r = 0; r < matrix.length; r++) {
        for (let c = 0; c < matrix[0].length; c++) {
          const cell = document.createElement('input');
          cell.value = matrix[r][c].toFixed(2);
          cell.disabled = true;
          result.appendChild(cell);
        }
      }
    };

    const operate = (type) => {
      const rows = parseInt(document.getElementById('rows').value);
      const cols = parseInt(document.getElementById('cols').value);
      const A = getMatrix('a', rows, cols);
      const B = getMatrix('b', rows, cols);

      let result = [];

      if (type === 'add') {
        result = A.map((row, i) => row.map((val, j) => val + B[i][j]));
      } else if (type === 'subtract') {
        result = A.map((row, i) => row.map((val, j) => val - B[i][j]));
      } else if (type === 'multiply') {
        if (A[0].length !== B.length) return alert("Kolom A harus sama dengan baris B!");
        for (let i = 0; i < rows; i++) {
          result[i] = [];
          for (let j = 0; j < cols; j++) {
            let sum = 0;
            for (let k = 0; k < cols; k++) {
              sum += A[i][k] * B[k][j];
            }
            result[i][j] = sum;
          }
        }
      } else if (type === 'transpose') {
        result = A[0].map((_, i) => A.map(row => row[i]));
      } else if (type === 'determinant') {
        if (rows !== cols) return alert("Harus matriks persegi!");
        result = determinant(A);
      } else if (type === 'inverse') {
        if (rows !== cols) return alert("Harus matriks persegi!");
        result = inverse(A);
        if (!result) return alert("Matriks tidak memiliki invers.");
      }

      displayResult(result);
    };

    const determinant = (m) => {
      const n = m.length;
      if (n === 2) return m[0][0]*m[1][1] - m[0][1]*m[1][0];
      if (n === 3) {
        return m[0][0]*(m[1][1]*m[2][2]-m[1][2]*m[2][1]) -
               m[0][1]*(m[1][0]*m[2][2]-m[1][2]*m[2][0]) +
               m[0][2]*(m[1][0]*m[2][1]-m[1][1]*m[2][0]);
      }
      return NaN;
    };

    const inverse = (m) => {
      const det = determinant(m);
      if (det === 0 || isNaN(det)) return null;
      const n = m.length;
      if (n === 2) {
        return [
          [ m[1][1]/det, -m[0][1]/det],
          [-m[1][0]/det,  m[0][0]/det]
        ];
      }
      return null;
    };

    const clearAll = () => {
      document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
      document.getElementById('result').innerHTML = '';
    };

    window.onload = createMatrices;
  </script>
</body>
</html>
